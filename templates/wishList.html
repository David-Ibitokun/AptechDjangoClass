{% extends 'base.html' %}
{% load static %}
{% block content %}
{% load humanize %}
<div class="container mt-5">
    <h2 class="mb-4 fw-bold text-primary">Your Wishlist</h2>

    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        {% endfor %}
    {% endif %}

    {% if wishlist_items %}
        <div class="row">
            {% for item in wishlist_items %}
            <div class="col-md-4 mb-4">
                <div class="card h-100 shadow-sm border-0 rounded-3"
                     style="transition: transform 0.3s ease;">

                    <!-- Product Image -->
                    <img src="{{ item.product.image.url }}"
                         class="card-img-top"
                         alt="{{ item.product.name }}"
                         style="object-fit: cover; height: 220px; border-top-left-radius: 0.5rem; border-top-right-radius: 0.5rem;">

                    <!-- Card Body -->
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title text-dark fw-semibold"
                            style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">
                            {{ item.product.name }}
                        </h5>

                        <p class="card-text mb-3"
                           style="font-size: 1.1rem; font-weight: bold; color: #222;">
                            â‚¦{{ item.product.price|intcomma }}
                        </p>

                        <div class="mt-auto d-flex justify-content-between">
                            <a href="{% url 'add_to_cart' item.product.id %}"
                               class="btn btn-sm btn-outline-primary px-3">
                                Add to Cart
                            </a>

                            {# CORRECTED LINE: Pass item.id (the Wishlist item's ID) #}
                            <a href="{% url 'remove_from_wishlist' item.id %}"
                               class="btn btn-sm btn-outline-danger px-3">
                                Remove
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="alert alert-info text-center mt-4">
            You haven't added any products to your wishlist yet.
        </div>
    {% endif %}
</div>
{% endblock %}
